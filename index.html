<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŠæˆ²å»³ - åæ‡‰åŠ›å¤§å¸«</title>
    <style>
        :root {
            --bg: #0a0e17;
            --card: rgba(30, 41, 59, 0.7);
            --primary: #38bdf8;
            --success: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --text: #f8fafc;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(circle at top right, #1e293b, #0a0e17);
            color: var(--text);
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        /* é ‚éƒ¨å°è¦½åˆ—ï¼šæ¯›ç»ç’ƒæ•ˆæœ */
        header {
            width: 100%;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            padding: 15px 0;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        h1 { margin: 0; font-size: 2rem; letter-spacing: 6px; text-transform: uppercase; color: var(--primary); }

        .top-stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 10px;
        }

        .stat-item {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--warning);
        }

        .nav { display: flex; justify-content: center; gap: 12px; margin: 15px 0; }
        .nav-btn {
            background: rgba(255,255,255,0.05); border: 1px solid var(--primary);
            color: var(--primary); padding: 10px 20px; border-radius: 30px;
            cursor: pointer; transition: 0.3s; font-weight: bold;
        }
        .nav-btn.active { background: var(--primary); color: var(--bg); box-shadow: 0 0 15px var(--primary); }

        /* éŠæˆ²ä¸»é«”å®¹å™¨ */
        .game-container {
            width: 95%;
            max-width: 600px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-bottom: 50px;
        }

        .game-box { display: none; width: 100%; }
        .game-box.active { display: block; animation: zoomIn 0.3s ease-out; }

        @keyframes zoomIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* --- åæ‡‰æŒ‘æˆ°ï¼šå¼·åŒ–ç‰ˆæ¨£å¼ --- */
        #reaction-stage {
            width: 100%;
            height: 400px;
            border-radius: 24px;
            background: var(--card);
            border: 2px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background 0.1s, transform 0.1s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        #reaction-stage:active { transform: scale(0.98); }

        .main-instruction {
            font-size: 3.5rem; /* å­—é«”åŠ å¤§ */
            font-weight: 900;
            text-align: center;
            pointer-events: none;
            text-shadow: 0 4px 10px rgba(0,0,0,0.5);
            margin: 0;
        }

        .sub-instruction {
            font-size: 1.2rem;
            margin-top: 20px;
            color: rgba(255,255,255,0.6);
            pointer-events: none;
        }

        .rank-badge {
            position: absolute;
            bottom: 30px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--warning);
            text-transform: uppercase;
            opacity: 0;
            transition: 0.3s;
        }

        /* é–ƒçˆå‹•ç•« (å¤±æ•—æ™‚) */
        .flash-red { animation: flashRed 0.4s; }
        @keyframes flashRed { 
            0%, 100% { background: var(--card); } 
            50% { background: var(--danger); } 
        }

    </style>
</head>
<body>

<header>
    <h1>éŠæˆ²å»³</h1>
    <div class="top-stats">
        <div class="stat-item">ğŸ’° <span id="coin-val">0</span></div>
        <div class="stat-item">âš¡ ç´€éŒ„: <span id="best-val">--</span>ms</div>
    </div>
    <div class="nav">
        <button class="nav-btn active" onclick="tab('react', this)">åæ‡‰æŒ‘æˆ°</button>
        <button class="nav-btn" onclick="tab('race', this)">ç˜‹ç‹‚è³½é¦¬</button>
        <button class="nav-btn" onclick="tab('hoop', this)">æŠ•ç±ƒæ¯”è³½</button>
    </div>
</header>

<div class="game-container">
    <div id="react" class="game-box active">
        <div id="reaction-stage" onclick="triggerReact()">
            <p id="main-text" class="main-instruction">READY?</p>
            <p id="sub-text" class="sub-instruction">é»æ“Šå€å¡Šé–‹å§‹æ¸¬è©¦</p>
            <div id="rank-text" class="rank-badge">GODLIKE!</div>
        </div>
    </div>

    <div id="race" class="game-box" style="text-align: center;"><h2>è³½é¦¬æ¨¡å¼è£½ä½œä¸­...</h2></div>
    <div id="hoop" class="game-box" style="text-align: center;"><h2>æŠ•ç±ƒæ¨¡å¼è£½ä½œä¸­...</h2></div>
</div>

<script>
    let coins = parseInt(localStorage.getItem('coins')) || 0;
    let best = localStorage.getItem('bestReact') || '--';
    let state = 'idle'; // idle, waiting, go
    let timer, startTime;

    const stage = document.getElementById('reaction-stage');
    const mainTxt = document.getElementById('main-text');
    const subTxt = document.getElementById('sub-text');
    const rankTxt = document.getElementById('rank-text');

    function syncData() {
        document.getElementById('coin-val').innerText = coins;
        document.getElementById('best-val').innerText = best;
        localStorage.setItem('coins', coins);
        localStorage.setItem('bestReact', best);
    }
    syncData();

    function tab(id, btn) {
        document.querySelectorAll('.game-box').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // --- åæ‡‰åŠ›æŒ‘æˆ°æ ¸å¿ƒå„ªåŒ–é‚è¼¯ ---
    function triggerReact() {
        if (state === 'idle') {
            startTest();
        } else if (state === 'waiting') {
            tooEarly();
        } else if (state === 'go') {
            success();
        }
    }

    function startTest() {
        state = 'waiting';
        stage.style.background = 'var(--warning)';
        stage.style.boxShadow = '0 0 40px rgba(245, 158, 11, 0.3)';
        mainTxt.innerText = 'WAIT...';
        mainTxt.style.color = '#fff';
        subTxt.innerText = 'çœ‹åˆ°è®Šè‰²ç¬é–“é»æ“Šï¼';
        rankTxt.style.opacity = '0';
        
        const delay = Math.random() * 3000 + 1500;
        timer = setTimeout(() => {
            state = 'go';
            stage.style.background = 'var(--success)';
            stage.style.boxShadow = '0 0 60px rgba(34, 197, 94, 0.5)';
            mainTxt.innerText = 'GO!!';
            startTime = Date.now();
        }, delay);
    }

    function tooEarly() {
        clearTimeout(timer);
        state = 'idle';
        stage.classList.add('flash-red');
        setTimeout(() => stage.classList.remove('flash-red'), 400);
        stage.style.background = 'var(--card)';
        stage.style.boxShadow = 'none';
        mainTxt.innerText = 'TOO EARLY!';
        mainTxt.style.color = 'var(--danger)';
        subTxt.innerText = 'é»æ“Šé‡è©¦';
    }

    function success() {
        const diff = Date.now() - startTime;
        state = 'idle';
        stage.style.background = 'var(--card)';
        stage.style.boxShadow = 'none';
        mainTxt.innerText = diff + 'ms';
        mainTxt.style.color = 'var(--primary)';
        subTxt.innerText = 'é»æ“Šå†æ¬¡æŒ‘æˆ°';

        // è©•åƒ¹ç³»çµ±
        let rank = '';
        let gain = 2;
        if (diff < 180) { rank = 'Godlike âš¡'; gain = 50; }
        else if (diff < 250) { rank = 'Legendary ğŸ”¥'; gain = 20; }
        else if (diff < 350) { rank = 'Excellent âœ¨'; gain = 10; }
        else { rank = 'Average ğŸ¢'; gain = 5; }

        rankTxt.innerText = rank;
        rankTxt.style.opacity = '1';
        
        coins += gain;
        if (best === '--' || diff < best) best = diff;
        syncData();
    }
</script>

</body>
</html>
