
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŠæˆ²å»³ - çµ‚æ¥µå„ªåŒ–ç‰ˆ</title>
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --primary: #38bdf8;
            --success: #4ade80;
            --danger: #fb7185;
            --gold: #fbbf24;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: #f8fafc;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* é ‚éƒ¨æ¨™é¡Œèˆ‡ç‹€æ…‹ */
        header {
            width: 100%;
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        h1 { margin: 0; font-size: 1.8rem; letter-spacing: 4px; color: var(--primary); }

        .stats-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .stat-badge {
            background: rgba(255,255,255,0.05);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            font-weight: bold;
        }

        /* å°è¦½ */
        .nav { display: flex; justify-content: center; gap: 8px; margin: 20px 0; }
        .nav-btn {
            background: transparent; border: 1px solid var(--primary);
            color: var(--primary); padding: 8px 16px; border-radius: 8px;
            cursor: pointer; transition: 0.3s;
        }
        .nav-btn.active { background: var(--primary); color: var(--bg); }

        /* éŠæˆ²å€åŸŸå®¹å™¨ */
        .game-wrapper {
            width: 90%;
            max-width: 500px;
            perspective: 1000px;
        }

        .game-box {
            display: none;
            background: var(--card);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .game-box.active { display: block; }

        /* --- åæ‡‰åŠ›ï¼šå„ªåŒ– --- */
        #reaction-area {
            width: 100%; height: 300px;
            border-radius: 15px;
            background: #334155;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            cursor: pointer; transition: 0.15s;
            border: 2px solid rgba(255,255,255,0.1);
        }
        #reaction-area:active { transform: scale(0.98); }
        .rank-text { margin-top: 10px; color: var(--gold); font-size: 0.9rem; }

        /* --- è³½é¦¬ï¼šå„ªåŒ– --- */
        .race-track { background: #0f172a; padding: 15px; border-radius: 12px; margin-top: 15px; }
        .horse-lane { 
            height: 50px; border-bottom: 1px solid rgba(255,255,255,0.05); 
            position: relative; display: flex; align-items: center; 
        }
        .horse-emoji { position: absolute; left: 0; font-size: 2rem; transition: left 0.1s linear; filter: drop-shadow(0 0 5px rgba(255,255,255,0.3)); }

        /* --- æŠ•ç±ƒï¼šå„ªåŒ– --- */
        #basketball-court {
            width: 100%; height: 300px; background: radial-gradient(circle at 50% 10%, #334155, #0f172a);
            position: relative; border-radius: 15px; overflow: hidden; cursor: crosshair;
        }
        #hoop-rim { 
            width: 60px; height: 12px; background: transparent; 
            border: 4px solid var(--danger); position: absolute; 
            top: 40px; left: 50%; border-radius: 50%; transform: translateX(-50%);
        }
        #bb-ball { 
            width: 35px; height: 35px; background: #f97316; border-radius: 50%;
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: none; box-shadow: inset -4px -4px 8px rgba(0,0,0,0.4);
        }

        .btn-action {
            background: var(--success); color: var(--bg); border: none;
            padding: 10px 20px; border-radius: 8px; font-weight: bold;
            cursor: pointer; width: 100%; margin-top: 15px;
        }
    </style>
</head>
<body>

<header>
    <h1>éŠæˆ²å»³</h1>
    <div class="stats-container">
        <div class="stat-badge">ğŸ’° <span id="coins">0</span></div>
        <div class="stat-badge">ğŸ† <span id="best-react">--</span> ms</div>
    </div>
    <div class="nav">
        <button class="nav-btn active" onclick="tab('react', this)">åæ‡‰æŒ‘æˆ°</button>
        <button class="nav-btn" onclick="tab('race', this)">ç˜‹ç‹‚è³½é¦¬</button>
        <button class="nav-btn" onclick="tab('hoop', this)">è¡—é ­æŠ•ç±ƒ</button>
    </div>
</header>

<div class="game-wrapper">
    <div id="react" class="game-box active">
        <div id="reaction-area" onclick="handleReact()">
            <div id="react-label" style="font-size: 1.5rem;">é»æ“Šé–‹å§‹</div>
            <div id="react-rank" class="rank-text">æº–å‚™å¥½æ¸¬è©¦ä½ çš„ç¥ç¶“å—ï¼Ÿ</div>
        </div>
    </div>

    <div id="race" class="game-box">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <select id="horse-pick" style="padding: 8px; border-radius: 5px;">
                <option value="0">1 è™Ÿé¦¬ ğŸ</option>
                <option value="1">2 è™Ÿé¦¬ ğŸ¦„</option>
                <option value="2">3 è™Ÿé¦¬ ğŸ¦“</option>
            </select>
            <div>ä¸‹æ³¨: <input type="number" id="bet-amt" value="10" min="1" style="width: 50px; padding: 5px;"></div>
        </div>
        <div class="race-track">
            <div class="horse-lane"><div class="horse-emoji" id="h0">ğŸ</div></div>
            <div class="horse-lane"><div class="horse-emoji" id="h1">ğŸ¦„</div></div>
            <div class="horse-lane"><div class="horse-emoji" id="h2">ğŸ¦“</div></div>
        </div>
        <button class="btn-action" onclick="startRace()">é–‹è³½ï¼(è³ ç‡ 3x)</button>
    </div>

    <div id="hoop" class="game-box">
        <div id="basketball-court" onclick="shoot(event)">
            <div id="hoop-rim"></div>
            <div id="bb-ball"></div>
        </div>
        <p style="font-size: 0.8rem; color: #94a3b8; margin-top: 10px;">é»æ“Šå ´åœ°ç™¼å°„ï¼å‘½ä¸­ç±ƒæ¡†å¾— 10 é‡‘å¹£ã€‚</p>
    </div>
</div>

<script>
    // --- è³‡æ–™åˆå§‹åŒ– ---
    let coins = parseInt(localStorage.getItem('coins')) || 100;
    let bestScore = localStorage.getItem('bestScore') || '--';
    
    function save() {
        localStorage.setItem('coins', coins);
        localStorage.setItem('bestScore', bestScore);
        document.getElementById('coins').innerText = coins;
        document.getElementById('best-react').innerText = bestScore;
    }
    save();

    function tab(id, btn) {
        document.querySelectorAll('.game-box').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // --- 1. åæ‡‰åŠ›éŠæˆ²å„ªåŒ– ---
    let rState = 'idle', rTimer, rStart;
    function handleReact() {
        const area = document.getElementById('reaction-area');
        const label = document.getElementById('react-label');
        if (rState === 'idle') {
            rState = 'wait';
            area.style.background = '#eab308';
            label.innerText = 'ç­‰å¾…è®Šè‰²...';
            rTimer = setTimeout(() => {
                rState = 'go';
                area.style.background = '#22c55e';
                label.innerText = 'é»æ“Šï¼ï¼';
                rStart = Date.now();
            }, Math.random() * 3000 + 2000);
        } else if (rState === 'wait') {
            clearTimeout(rTimer);
            rState = 'idle';
            area.style.background = '#ef4444';
            label.innerText = 'å¤ªæ—©äº†ï¼(é‡è©¦)';
        } else if (rState === 'go') {
            const diff = Date.now() - rStart;
            rState = 'idle';
            area.style.background = '#334155';
            label.innerText = diff + ' ms';
            
            let rank = 'å‡¡äºº';
            if (diff < 200) rank = 'âš¡ ç¥ä¹‹åæ‡‰ï¼';
            else if (diff < 280) rank = 'ğŸ”¥ æ¥µé€Ÿæ‰‹é€Ÿ';
            else if (diff > 500) rank = 'ğŸ¢ è©²å–å’–å•¡äº†';
            document.getElementById('react-rank').innerText = 'è©•åƒ¹ï¼š' + rank;

            if (bestScore === '--' || diff < bestScore) bestScore = diff;
            coins += (diff < 300 ? 20 : 5);
            save();
        }
    }

    // --- 2. è³½é¦¬éŠæˆ²å„ªåŒ– ---
    let racing = false;
    function startRace() {
        const bet = parseInt(document.getElementById('bet-amt').value);
        if (racing || coins < bet) return alert('é¤˜é¡ä¸è¶³æˆ–æ­£åœ¨æ¯”è³½ï¼');
        coins -= bet; save(); racing = true;
        
        let p = [0, 0, 0];
        const timer = setInterval(() => {
            for (let i = 0; i < 3; i++) {
                p[i] += Math.random() * 2.8;
                document.getElementById('h' + i).style.left = p[i] + '%';
                if (p[i] >= 90) {
                    clearInterval(timer);
                    const win = (i == document.getElementById('horse-pick').value);
                    if (win) { coins += bet * 3; alert('ğŸ‰ ä½ è´äº†ï¼ç²å¾— ' + (bet*3) + ' é‡‘å¹£'); }
                    else { alert('âŒ è¼¸äº†ï¼å† è»æ˜¯ ' + (i+1) + ' è™Ÿé¦¬'); }
                    save(); racing = false;
                    p.forEach((_, idx) => document.getElementById('h' + idx).style.left = '0');
                }
            }
        }, 40);
    }

    // --- 3. æŠ•ç±ƒéŠæˆ²å„ªåŒ– ---
    let hoopX = 50, hoopDir = 1.2;
    setInterval(() => {
        hoopX += hoopDir;
        if (hoopX > 80 || hoopX < 20) hoopDir *= -1;
        document.getElementById('hoop-rim').style.left = hoopX + '%';
    }, 20);

    let shooting = false;
    function shoot(e) {
        if (shooting) return;
        shooting = true;
        const ball = document.getElementById('bb-ball');
        const court = document.getElementById('basketball-court').getBoundingClientRect();
        const targetX = ((e.clientX - court.left) / court.width) * 100;
        
        ball.style.display = 'block';
        let bY = 20, bX = 50, bSize = 35;
        const drift = (targetX - 50) / 20;

        const anim = setInterval(() => {
            bY += 8; bX += drift; bSize -= 0.5; // çƒé£›é æœƒç¸®å°
            ball.style.bottom = bY + 'px';
            ball.style.left = bX + '%';
            ball.style.width = bSize + 'px';
            ball.style.height = bSize + 'px';

            if (bY > 250) {
                clearInterval(anim);
                if (Math.abs(bX - hoopX) < 7) {
                    coins += 10; save();
                    document.getElementById('hoop-rim').style.borderColor = '#fbbf24';
                    setTimeout(() => document.getElementById('hoop-rim').style.borderColor = 'var(--danger)', 300);
                }
                ball.style.display = 'none';
                shooting = false;
            }
        }, 20);
    }
</script>

</body>
</html>
